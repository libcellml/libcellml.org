import{p as $,J as U,r as _,K as z,c as A,o as i,a as k,h as a,w as t,L as f,n as m,f as H,b as h,V as R,l as q,C as G,A as J,G as B,F as M,i as D,s as K,d as p,e as P,q as j,H as O,I as Q}from"./index-45856ec8.js";import{_ as I,a as L}from"./IssueHeading-18486d50.js";import{V as W}from"./VFileInput-285a6b06.js";const w=g=>(O("data-v-d888ea12"),g=g(),Q(),g),X={class:"validate"},Y=w(()=>p("h1",null,"Validate CellML models",-1)),Z=w(()=>p("p",null,[h(" This service will accept CellML 2.0 files and check for syntactic validity against the "),p("a",{href:"https://www.cellml.org/specifications/cellml_2.0",target:"_blank"},"CellML Normative Specification")],-1)),ee=w(()=>p("br",null,null,-1)),le={style:{"padding-right":"0.5em","font-weight":"600"}},te=w(()=>p("span",null,"The model is valid!",-1)),ae={__name:"Validate",setup(g){const b=U(),v=_([]),u=_([]),V=_(!1),F=_(!1),y=_(!1),c=_(""),C=z("$libcellml"),S=A(()=>C.state==="ready"&&u.value.length>0?void 0:!0);function x(o){v.value.splice(o,1)}function T(o){let l=new C.module.Parser(!0),e=new C.module.Validator,s=null;try{s=l.parseModel(o)}catch(r){return l.delete(),e.delete(),{issues:[{description:"Error encountered while parsing file.  Error: "+r.message}],type:"parser"}}let n=[],d=0;if(l.errorCount()){for(;d<l.errorCount();){let r=l.error(d);n.push({description:r.description()}),r.delete(),d++}return l.delete(),e.delete(),s.delete(),{issues:n,type:"parser"}}for(d=0,e.validateModel(s);d<e.errorCount();){let r=e.error(d);n.push({description:r.description(),ref:r.referenceHeading(),url:r.url()}),r.delete(),d++}return F.value=n.length>0,l.delete(),e.delete(),s.delete(),{issues:n,type:"validator"}}function E(){F.value=!1,V.value=!1,c.value="",v.value=[]}function N(){E();const o=new FileReader;o.readAsText(u.value[0],"UTF-8"),o.onload=function(l){try{let e=T(l.target.result);c.value=u.value[0].name,v.value=e.issues,y.value=!!(e.type==="parser"&&e.issues.length),V.value=!!(e.type==="validator"&&e.issues.length)}catch(e){y.value=!0,b.add({type:"error",title:"File read error:",message:"Could not validate file: "+e.message})}},o.onerror=function(l){b.add({type:"error",title:"File read error:",message:u.name})}}return(o,l)=>(i(),k("div",X,[Y,Z,a(f,null,{default:t(()=>[a(W,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=e=>u.value=e),"show-size":"","truncate-length":"64",label:"Upload model"},{default:t(()=>[h(" >")]),_:1},8,["modelValue"])]),_:1}),a(f,null,{default:t(()=>[a(R,{justify:"center"},{default:t(()=>[a(q,{class:"col-12 col-md-4",id:"validateButton"},{default:t(()=>[a(G,{block:"",class:J("big-button"),disabled:S.value,onClick:N},{default:t(()=>[a(B,{color:"white","x-large":""},{default:t(()=>[h("mdi-file-check-outline")]),_:1}),ee,h(" Validate CellML 2.0 syntax ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),y.value?(i(),m(f,{key:0},{default:t(()=>[a(I,{title:c.value},null,8,["title"]),(i(!0),k(M,null,D(v.value,(e,s)=>(i(),m(L,{key:"parser_issue_"+s,issue:e,onDismiss:n=>x(s)},null,8,["issue","onDismiss"]))),128))]),_:1})):V.value?(i(),m(f,{key:1},{default:t(()=>[a(I,{title:c.value,issueSource:"Validation"},null,8,["title"]),(i(!0),k(M,null,D(v.value,(e,s)=>(i(),m(L,{key:"validation_issue_"+s,issue:e,onLearnButton:!0,onDismiss:n=>x(s)},null,8,["issue","onDismiss"]))),128))]),_:1})):!y.value&&!V.value&&c.value?(i(),m(f,{key:2},{default:t(()=>[a(j,{class:"noErrors",elevation:"0"},{default:t(()=>[a(K,null,{default:t(()=>[a(B,{large:""},{default:t(()=>[h("mdi-check-bold")]),_:1}),p("span",le,P(c.value)+":",1),te]),_:1})]),_:1})]),_:1})):H("",!0)]))}},ie=$(ae,[["__scopeId","data-v-d888ea12"]]);export{ie as default};
